<!-- 61aaa78b-e47d-4e75-a240-49f5ab6561e8 f064b64a-29c6-487f-bb4c-4694a580e216 -->
# 리뷰 텍스트 임베딩을 모델 학습 및 서비스에 추가

## 목표

- 리뷰 텍스트(한글 번역문)를 TF-IDF로 임베딩 (100차원)
- DeepFM, Multi-Tower 모델 학습에 텍스트 피처 포함
- 실제 서비스(prediction_service.py)에서도 동일하게 적용
- 코랩에서 학습 가능하도록 구성

## 구현 내용

### 1. TF-IDF 임베딩 생성 스크립트

**파일**: `scripts/step2_create_text_embeddings.py` (신규)

- `data/raw/review_100k_absa_with_text.csv`에서 리뷰 텍스트 로드
- TF-IDF Vectorizer 학습 (max_features=100, min_df=5)
- 각 리뷰를 100차원 벡터로 변환
- 결과를 `data/processed/review_text_embeddings.csv`로 저장
- Vectorizer를 `models/tfidf_vectorizer.pkl`로 저장

### 2. 학습 데이터 생성 수정

**파일**: `scripts/step3_create_ranking_data.py` (수정)

- 텍스트 임베딩 로드 및 병합
- User-Business 쌍별 평균 텍스트 임베딩 계산
- 피처 구성: 기본 피처 + ABSA 피처 + 텍스트 임베딩(100차원)
- Train/Valid/Test 데이터에 모두 포함

### 3. DeepFM 학습 스크립트 수정

**파일**: `scripts/step4_train_deepfm.py` (수정)

- 입력 차원 업데이트: 112 → 212 (기존 + 텍스트 100차원)
- 나머지 로직 동일

### 4. Multi-Tower 학습 스크립트 생성

**파일**: `scripts/step5_train_multitower.py` (신규)

- User Tower: User 피처(57개) + User 평균 텍스트(50차원) = 107차원
- Business Tower: Business 피처(55개) + Business 평균 텍스트(50차원) = 105차원
- 학습 로직 구현

### 5. 실제 서비스 수정

**파일**: `backend_model/prediction_service.py` (수정)

- TF-IDF Vectorizer 로딩 추가
- 새로운 리뷰 텍스트를 임베딩으로 변환
- User/Business별 평균 텍스트 임베딩 계산 로직 추가
- 모델 입력에 텍스트 임베딩 포함
- DB 스키마 변경 필요 시 대응 (User/Business 테이블에 평균 텍스트 임베딩 저장 고려)

### 6. 텍스트 임베딩 유틸리티

**파일**: `backend_model/utils/text_embedding.py` (신규)

- TF-IDF 변환 헬퍼 함수
- 학습/서비스 양쪽에서 사용 가능한 공통 유틸리티

## 주요 변경 사항

- 입력 피처 차원: 112 → 212 (DeepFM), 56/56 → 107/105 (Multi-Tower)
- 새로운 파일: TF-IDF vectorizer 모델 (.pkl)
- CSV 파일: 텍스트 임베딩 100개 컬럼 추가

## 실행 순서

1. `scripts/step2_create_text_embeddings.py` - TF-IDF 학습
2. `scripts/step3_create_ranking_data.py` - 데이터 생성
3. `scripts/step4_train_deepfm.py` - DeepFM 학습 (코랩)
4. `scripts/step5_train_multitower.py` - Multi-Tower 학습 (코랩)
5. 모델 파일들을 로컬로 복사 후 서비스 사용