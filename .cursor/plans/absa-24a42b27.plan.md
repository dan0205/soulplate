<!-- 24a42b27-3403-4861-8644-e04baa5130c9 3bd076d4-815a-4e8b-b430-c025ed6ed09c -->
# ABSA 기반 사용자-비즈니스 별점 예측 모델 구축

## 목표

100k 한국어 리뷰 데이터에 ABSA(Aspect-Based Sentiment Analysis) 모델을 적용하여, 사용자가 특정 비즈니스에 매길 별점을 예측하는 두 개의 랭킹 모델(DeepFM, Multi-Tower)을 학습합니다.

## 데이터

- **Users**: 42,223명 (`user_filtered.csv`)
- **Businesses**: 14,519개 (`business_filtered.csv`)
- **Reviews**: 100,000개 한국어 번역 (`review_100k_translated.csv`)
- **ABSA 모델**: `/content/drive/MyDrive/study-absa-lmkor/final_model/`
- 17개 aspects: 맛, 짠맛, 매운맛, 단맛, 느끼함, 담백함, 고소함, 품질/신선도, 양, 서비스, 가격, 쾌적함/청결도, 소음, 분위기, 공간, 주차, 대기
- 3개 sentiments: 긍정, 부정, 중립

## Phase 1: ABSA 모델 테스트 및 검증

### Step 0: 테스트 스크립트

- ABSA 모델 로딩 테스트
- 1개 리뷰로 입력/출력 형식 확인
- GPU(RTX 2080) 사용 확인

### 파일: `scripts/test_absa_model.py`

## Phase 2: ABSA 피처 생성

### Step 1: ABSA 추론

- 100,000개 리뷰에 ABSA 모델 적용
- 각 리뷰당 17 aspects × 3 sentiments = 51개 피처 생성
- 배치 처리 (10k씩) + GPU 가속
- 예상 시간: 1-2시간

### 파일: `scripts/step1_run_absa.py`

### 출력: `data/processed/review_absa_features.csv`

## Phase 3: 피처 집계

### Step 2: User/Business 피처 집계

- User별 ABSA 피처 평균 계산
- Business별 ABSA 피처 평균 계산
- 기본 피처와 결합

### 파일: `scripts/step2_aggregate_features.py`

### 출력: 

- `data/processed/user_aggregated.csv` (42k users × 57 features)
- `data/processed/business_aggregated.csv` (14k businesses × 56 features)

## Phase 4: 학습 데이터 생성

### Step 3: (User, Business) 쌍 생성

- 각 (user_id, business_id) 쌍의 평균 별점 계산
- Train/Valid/Test 분할 (80/10/10)

### 파일: `scripts/step3_create_ranking_data.py`

### 출력:

- `data/processed/ranking_train.csv`
- `data/processed/ranking_valid.csv`
- `data/processed/ranking_test.csv`

## Phase 5: DeepFM 모델 학습

### Step 4: DeepFM 학습

- FM Layer: 피처 조합 자동 학습
- Deep Layer: 비선형 패턴 학습
- Loss: MSE, Metric: RMSE
- Batch Size: 512, Epochs: 20

### 파일:

- `backend_model/models/deepfm_ranking.py` (모델 정의)
- `scripts/step4_train_deepfm.py` (학습 스크립트)

### 출력: `models/deepfm_ranking.pth`

## Phase 6: Multi-Tower 모델 학습

### Step 5: Multi-Tower 학습

- User Tower: User 피처 → 64-dim embedding
- Business Tower: Business 피처 → 64-dim embedding
- Interaction Layer: 두 임베딩 결합 → 별점 예측

### 파일:

- `backend_model/models/multitower_ranking.py` (모델 정의)
- `scripts/step5_train_multitower.py` (학습 스크립트)

### 출력: `models/multitower_ranking.pth`

## Phase 7: 평가 및 비교

### Step 6: 모델 평가

- Test Set RMSE 계산
- 두 모델 예측 비교
- 앙상블 성능 측정

### 파일: `scripts/step6_evaluate_models.py`

## 주요 파일

### 모델 정의

- `backend_model/models/deepfm_ranking.py`
- `backend_model/models/multitower_ranking.py`

### 스크립트

- `scripts/test_absa_model.py`
- `scripts/step1_run_absa.py`
- `scripts/step2_aggregate_features.py`
- `scripts/step3_create_ranking_data.py`
- `scripts/step4_train_deepfm.py`
- `scripts/step5_train_multitower.py`
- `scripts/step6_evaluate_models.py`

## 예상 소요 시간

- ABSA 추론: 1-2시간 (GPU)
- 피처 집계: 5분
- 데이터 생성: 2분
- DeepFM 학습: 30분
- Multi-Tower 학습: 30분
- 평가: 5분
- **총: 3-4시간**

### To-dos

- [ ] ABSA 모델 로딩 및 추론 테스트 (1개 리뷰)
- [ ] 100k 리뷰에 ABSA 추론 실행 (GPU 가속)
- [ ] User/Business 단위 ABSA 피처 집계
- [ ] 학습 데이터 생성 (user-business 쌍, 평균 별점)
- [ ] DeepFM 랭킹 모델 학습 및 저장
- [ ] Multi-Tower 랭킹 모델 학습 및 저장
- [ ] 두 모델 평가 및 비교 분석